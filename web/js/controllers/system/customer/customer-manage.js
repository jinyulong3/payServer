app.controller("customerManage",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(n,e,s,o,i,a){n.getgroupListSendData={sessionId:n.app.myData.sessionId,tableName:"groups_list",fields:[],limit:"",offset:""},n.filterOptions={filterText:"",useExternalFilter:!0},n.totalServerItems=0,n.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},n.columnDefs=[{field:"group_id",displayName:a.instant("items.customerManage.group_id"),width:"*"},{field:"groupName",displayName:a.instant("items.customerManage.groupName"),width:"*"},{field:"address",displayName:a.instant("items.customerManage.address"),width:"*"},{field:"telephone",displayName:a.instant("items.customerManage.telephone"),width:"*"},{field:"linkman",displayName:a.instant("items.customerManage.linkman"),width:"*"},{field:"linkman_tel",displayName:a.instant("items.customerManage.linkman_tel"),width:"*"},{field:"remark",displayName:a.instant("items.customerManage.remark"),width:"*"},{field:"time_instert",displayName:a.instant("items.customerManage.regTime"),width:"*",cellFilter:"filterDateStringSplitMs"}],n.callback=function(a){n.myData=a.fieldValues,n.totalServerItems=a.allCount,s.clear()},n.setPagingData=function(a,t){n.getgroupListSendData.offset=1==a?0:(a-1)*t,n.getgroupListSendData.limit=t,o.myPost2(i.URL.systemUrl,n.getgroupListSendData,i.msgIdName.normalSelectMsgId,i.msgIdName.normalSelectMsgName,n.callback)},n.getPagedDataAsync=function(a,t,e){setTimeout(function(){s.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.loadingData),n.setPagingData(t,a)},100)},n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage),n.$watch("pagingOptions",function(a,t){a!==t&&n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},!0),n.$watch("filterOptions",function(a,t){a!==t&&n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},!0),n.gridOptions={i18n:"undefined"!=n.app.myData.lang?n.app.myData.lang:"zh-cn",data:"myData",enablePaging:!0,showFooter:!0,footerRowHeight:40,totalServerItems:"totalServerItems",pagingOptions:n.pagingOptions,enableColumnResizing:!0,rowHeight:28,enableRowSelection:!0,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,showSelectionCheckbox:!0,filterOptions:n.filterOptions},app.controller("btnClickAddCustomerCon",["$scope","$uibModalInstance","info","parentScope",function(a,t,e,n){a.info=e,a.ok=function(){a.info.sessionId=n.app.myData.sessionId,a.info.datatype=i.cmdType.ADD,a.info.level=1,a.callback2=function(a){s.clear(),s.pop("success",constantsLang[n.app.myData.lang].tips.success,constantsLang[n.app.myData.lang].tips.addSuccess,i.TIMEOUT.timeout1s),t.dismiss(0),n.app.myData.groupList.push({group_id:a.group_id,groupName:a.groupName}),n.app.myData.groupListNoAll.push({group_id:a.group_id,groupName:a.groupName}),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},o.myPost2(i.URL.systemUrl,a.info,i.msgIdName.customerManageMsgId,i.msgIdName.customerManageMsgName,a.callback2,t),s.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.addingData)},a.cancel=function(){t.dismiss(0)}}]),n.btnClickAddCustomer=function(){var a=n;e.open({templateUrl:"tpl/system/customer/addCustomer.html",controller:"btnClickAddCustomerCon",size:"md",resolve:{parentScope:a,info:function(){return{}}}})},app.controller("btnClickEditCustomerCon",["$scope","$uibModalInstance","info","parentScope",function(a,t,e,n){a.info=e,a.ok=function(){a.info.sessionId=n.app.myData.sessionId,a.info.datatype=i.cmdType.CHANGE,console.log(a.info),a.callback3=function(e){s.clear(),s.pop("success",constantsLang[n.app.myData.lang].tips.success,constantsLang[n.app.myData.lang].tips.editSuccess,i.TIMEOUT.timeout1s),t.dismiss(0),n.app.myData.groupList.forEach(function(a,t){a.group_id==e.group_id&&(n.app.myData.groupList[t].groupName=e.groupName)}),n.app.myData.groupListNoAll.forEach(function(a,t){a.group_id==e.group_id&&(n.app.myData.groupListNoAll[t].groupName=e.groupName)}),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},o.myPost2(i.URL.systemUrl,a.info,i.msgIdName.customerManageMsgId,i.msgIdName.customerManageMsgName,a.callback3,t),s.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.editingData)},a.cancel=function(){t.dismiss(0)}}]),n.btnClickEditCustomer=function(){var a=n.gridOptions.$gridScope.selectedItems;if(console.log(a[0]),0==a.length)s.pop("info",constantsLang[n.app.myData.lang].tips.tip,constantsLang[n.app.myData.lang].tips.noSelectRow);else{var t=n;e.open({templateUrl:"tpl/system/customer/editCustomer.html",controller:"btnClickEditCustomerCon",size:"md",resolve:{parentScope:t,info:function(){return a[0]}}})}},app.controller("btnClickDelCustomerCon",["$scope","$uibModalInstance","info","parentScope",function(a,t,e,n){a.info=e,a.ok=function(){a.info.sessionId=n.app.myData.sessionId,a.info.datatype=i.cmdType.DEL,a.callback3=function(e){s.clear(),s.pop("success",constantsLang[n.app.myData.lang].tips.success,constantsLang[n.app.myData.lang].tips.deleteSuccess,i.TIMEOUT.timeout1s),t.dismiss(0),n.app.myData.groupList.forEach(function(a,t){a.group_id==e.group_id&&n.app.myData.groupList.splice(t,1)}),n.app.myData.groupListNoAll.forEach(function(a,t){a.group_id==e.group_id&&n.app.myData.groupListNoAll.splice(t,1)}),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},o.myPost2(i.URL.systemUrl,a.info,i.msgIdName.customerManageMsgId,i.msgIdName.customerManageMsgName,a.callback3,t),s.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.deletingData)},a.cancel=function(){t.dismiss(0)}}]),n.btnClickDelCustomer=function(){var a=n.gridOptions.$gridScope.selectedItems;if(0==a.length)s.pop("info",constantsLang[n.app.myData.lang].tips.tip,constantsLang[n.app.myData.lang].tips.noSelectRow);else{var t=n;e.open({templateUrl:"tpl/system/customer/delCustomer.html",controller:"btnClickDelCustomerCon",size:"md",resolve:{parentScope:t,info:function(){return a[0]}}})}}}]);