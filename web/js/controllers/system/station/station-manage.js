app.controller("stationManage",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(e,n,i,s,o,t){e.selected_group_id=0,console.log(e.app),0!=e.app.myData.role&&(e.selected_group_id=e.app.myData.groupListNoAll[0].group_id),e.selectChange=function(){console.log(e.selected_group_id),"0"!=e.selected_group_id?e.getStationListSendData.where=" group_id='"+e.selected_group_id+"'":e.getStationListSendData.where="",e.getPagedDataAsync(e.pagingOptions.pageSize,1,e.getStationListSendData)},e.getStationListSendData={sessionId:e.app.myData.sessionId,tableName:"view_station_group",fields:[],where:"",limit:"",offset:""},e.filterOptions={filterText:"",useExternalFilter:!0},e.totalServerItems=0,e.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},e.columnDefs=[{field:"group_id",displayName:t.instant("items.customerManage.group_id"),width:"*"},{field:"groupName",displayName:t.instant("items.customerManage.groupName"),width:"*"},{field:"station_id",displayName:t.instant("items.stationManage.station_id"),width:"*"},{field:"stationName",displayName:t.instant("items.stationManage.stationName"),width:"*"},{field:"address",displayName:t.instant("items.stationManage.address"),width:"*"},{field:"telephone",displayName:t.instant("items.stationManage.telephone"),width:"*"},{field:"linkman",displayName:t.instant("items.stationManage.linkman"),width:"*"},{field:"linkman_tel",displayName:t.instant("items.stationManage.linkman_tel"),width:"*"},{field:"remark",displayName:t.instant("items.stationManage.remark"),width:"*"},{field:"time_insert",displayName:t.instant("items.stationManage.regTime"),width:"*",cellFilter:"filterDateStringSplitMs"}],e.callback=function(t){e.myData=t.fieldValues,e.totalServerItems=t.allCount,i.clear()},e.setPagingData=function(t,a){e.getStationListSendData.offset=1==t?0:(t-1)*a,e.getStationListSendData.limit=a,s.myPost2(o.URL.systemUrl,e.getStationListSendData,o.msgIdName.normalSelectMsgId,o.msgIdName.normalSelectMsgName,e.callback)},e.getPagedDataAsync=function(t,a,n){setTimeout(function(){i.pop("wait",constantsLang[e.app.myData.lang].load.reqData,constantsLang[e.app.myData.lang].load.loadingData),e.setPagingData(a,t)},100)},e.getPagedDataAsync(e.pagingOptions.pageSize,e.pagingOptions.currentPage),e.$watch("pagingOptions",function(t,a){t!==a&&e.getPagedDataAsync(e.pagingOptions.pageSize,e.pagingOptions.currentPage,e.filterOptions.filterText)},!0),e.$watch("filterOptions",function(t,a){t!==a&&e.getPagedDataAsync(e.pagingOptions.pageSize,e.pagingOptions.currentPage,e.filterOptions.filterText)},!0),e.gridOptions={i18n:"undefined"!=e.app.myData.lang?e.app.myData.lang:"zh-cn",data:"myData",enablePaging:!0,showFooter:!0,footerRowHeight:40,totalServerItems:"totalServerItems",pagingOptions:e.pagingOptions,enableColumnResizing:!0,rowHeight:28,enableRowSelection:!0,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,showSelectionCheckbox:!0,filterOptions:e.filterOptions},app.controller("btnClickAddStationCon",["$scope","$uibModalInstance","info","parentScope",function(t,a,n,e){t.info=n,t.groupListNoAll=e.app.myData.groupListNoAll,t.info.group_id=t.groupListNoAll[0].group_id,t.ok=function(){t.info.sessionId=e.app.myData.sessionId,t.info.datatype=o.cmdType.ADD,t.callback2=function(t){i.clear(),i.pop("success",constantsLang[e.app.myData.lang].tips.success,constantsLang[e.app.myData.lang].tips.addSuccess,o.TIMEOUT.timeout1s),a.dismiss(0),e.getPagedDataAsync(e.pagingOptions.pageSize,e.pagingOptions.currentPage,e.filterOptions.filterText)},s.myPost2(o.URL.systemUrl,t.info,o.msgIdName.stationManageMsgId,o.msgIdName.stationManageMsgName,t.callback2,a),i.pop("wait",constantsLang[e.app.myData.lang].load.reqData,constantsLang[e.app.myData.lang].load.addingData)},t.cancel=function(){console.log(t.info),a.dismiss(0)}}]),e.btnClickAddStation=function(){var t=e;n.open({templateUrl:"tpl/system/station/addStation.html",controller:"btnClickAddStationCon",size:"md",resolve:{parentScope:t,info:function(){return{}}}})},app.controller("btnClickEditStationCon",["$scope","$uibModalInstance","info","parentScope",function(t,a,n,e){t.info=n,t.ok=function(){t.info.sessionId=e.app.myData.sessionId,t.info.datatype=o.cmdType.CHANGE,t.callback3=function(n){i.clear(),i.pop("success",constantsLang[e.app.myData.lang].tips.success,constantsLang[e.app.myData.lang].tips.editSuccess,o.TIMEOUT.timeout1s),a.dismiss(0),void 0!==e.app.myData.stationList&&e.app.myData.stationList.forEach(function(t,a){t.station_id==n.station_id&&(e.app.myData.stationList[a].stationName=n.stationName)}),e.getPagedDataAsync(e.pagingOptions.pageSize,e.pagingOptions.currentPage,e.filterOptions.filterText)},s.myPost2(o.URL.systemUrl,t.info,o.msgIdName.stationManageMsgId,o.msgIdName.stationManageMsgName,t.callback3,a),i.pop("wait",constantsLang[e.app.myData.lang].load.reqData,constantsLang[e.app.myData.lang].load.editingData)},t.cancel=function(){a.dismiss(0)}}]),e.btnClickEditStation=function(){var t=e.gridOptions.$gridScope.selectedItems;if(console.log(t[0]),0==t.length)i.pop("info",constantsLang[e.app.myData.lang].tips.tip,constantsLang[e.app.myData.lang].tips.noSelectRow);else{var a=e;n.open({templateUrl:"tpl/system/station/editStation.html",controller:"btnClickEditStationCon",size:"md",resolve:{parentScope:a,info:function(){return t[0]}}})}},app.controller("btnClickDelStationCon",["$scope","$uibModalInstance","info","parentScope",function(t,a,n,e){t.info=n,t.ok=function(){t.info.sessionId=e.app.myData.sessionId,t.info.datatype=o.cmdType.DEL,t.callback3=function(t){i.clear(),i.pop("success",constantsLang[e.app.myData.lang].tips.success,constantsLang[e.app.myData.lang].tips.deleteSuccess,o.TIMEOUT.timeout1s),a.dismiss(0),e.getPagedDataAsync(e.pagingOptions.pageSize,e.pagingOptions.currentPage,e.filterOptions.filterText)},s.myPost2(o.URL.systemUrl,t.info,o.msgIdName.stationManageMsgId,o.msgIdName.stationManageMsgName,t.callback3,a),i.pop("wait",constantsLang[e.app.myData.lang].load.reqData,constantsLang[e.app.myData.lang].load.deletingData)},t.cancel=function(){a.dismiss(0)}}]),e.btnClickDelStation=function(){var t=e.gridOptions.$gridScope.selectedItems;if(0==t.length)i.pop("info",constantsLang[e.app.myData.lang].tips.tip,constantsLang[e.app.myData.lang].tips.noSelectRow);else{var a=e;n.open({templateUrl:"tpl/system/station/delStation.html",controller:"btnClickDelStationCon",size:"md",resolve:{parentScope:a,info:function(){return t[0]}}})}}}]);