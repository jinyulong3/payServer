app.controller("queryTransCollect",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(l,t,s,a,i,e){l.selected_customerId="",l.selected_stationId="",l.app.myData.customerListNoAll=l.app.myData.customerList.slice(0),console.log(l.app.myData.customerListNoAll),"0"==l.app.myData.customerListNoAll[0].customerId&&l.app.myData.customerListNoAll.splice(0,1),1<l.app.myData.role?(l.default_search_select_station_list={stationId:"0",stationName:"全部"},l.search_select_station_list=[l.default_search_select_station_list],l.selected_stationId="0"):l.search_select_station_list=[],i.getStationListSendData.sessionId=l.app.myData.sessionId,0!=l.app.myData.role&&(l.selected_customerId=l.app.myData.customerListNoAll[0].customerId),l.callback_getStationList=function(t){l.search_select_station_list=l.search_select_station_list.concat(t.fieldValues)},l.selectCustomerChange=function(){console.log(l.selected_customerId),l.search_select_station_list=[l.default_search_select_station_list],"0"!=l.selected_customerId?i.getStationListSendData.where=" customerId='"+l.selected_customerId+"'":i.getStationListSendData.where="",a.myPost2(i.URL.systemUrl,i.getStationListSendData,i.msgIdName.normalSelectMsgId,i.msgIdName.normalSelectMsgName,l.callback_getStationList)},1==l.app.myData.role&&l.selectCustomerChange(),l.selectStationChange=function(){console.log(l.selected_customerId),l.getTransCollectSendData.stationId=l.selected_stationId},l.startDate="2019-01-01",l.stopDate="2029-11-11",l.getTransCollectSendData={sessionId:l.app.myData.sessionId,stationId:l.selected_stationId,startTime:l.startDate,endTime:l.stopDate},l.filterOptions={filterText:"",useExternalFilter:!0},l.totalServerItems=0,l.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},l.columnDefs=[{field:"stationId",displayName:e.instant("items.stationManage.stationId"),width:"*"},{field:"allTransCount",displayName:e.instant("items.transCollect.allTransCount"),width:"*"},{field:"allMoney",displayName:e.instant("items.transCollect.allMoney"),width:"*",cellFilter:"filterSystemPraMoneyDecStationId:this"},{field:"allVolume",displayName:e.instant("items.transCollect.allVolume"),width:"*",cellFilter:"filterSystemPraTotalizerDecStationId:this"},{field:"allDiscount",displayName:e.instant("items.transCollect.allDiscount"),width:"*",cellFilter:"filterSystemPraMoneyDecStationId:this"}],l.columnDefs2=[{field:"nozzleNum",displayName:e.instant("items.nozzleManage.logicNozzleNo"),width:"*"},{field:"countCollect",displayName:e.instant("items.transCollect.count"),width:"*"},{field:"moneyCollect",displayName:e.instant("items.trans.money"),width:"*",cellFilter:"filterSystemPraMoneyDecStationId:this"},{field:"volumeCollect",displayName:e.instant("items.trans.volume"),width:"*",cellFilter:"filterSystemPraTotalizerDecStationId:this"},{field:"discountCollect",displayName:e.instant("items.trans.discount"),width:"*",cellFilter:"filterSystemPraMoneyDecStationId:this"}],l.columnDefs3=[{field:"payType",displayName:e.instant("items.trans.payType"),width:"*",cellFilter:"filterPayType:this"},{field:"countCollect",displayName:e.instant("items.transCollect.count"),width:"*"},{field:"moneyCollect",displayName:e.instant("items.trans.money"),width:"*",cellFilter:"filterSystemPraMoneyDecStationId:this"},{field:"volumeCollect",displayName:e.instant("items.trans.volume"),width:"*",cellFilter:"filterSystemPraTotalizerDecStationId:this"},{field:"discountCollect",displayName:e.instant("items.trans.discount"),width:"*",cellFilter:"filterSystemPraMoneyDecStationId:this"}],l.columnDefs4=[{field:"oilName",displayName:e.instant("items.oilManage.oilName"),width:"*"},{field:"countCollect",displayName:e.instant("items.transCollect.count"),width:"*"},{field:"moneyCollect",displayName:e.instant("items.trans.money"),width:"*",cellFilter:"filterSystemPraMoneyDecStationId:this"},{field:"volumeCollect",displayName:e.instant("items.trans.volume"),width:"*",cellFilter:"filterSystemPraTotalizerDecStationId:this"},{field:"discountCollect",displayName:e.instant("items.trans.discount"),width:"*",cellFilter:"filterSystemPraMoneyDecStationId:this"}],l.callback=function(t){console.log(t),l.myData=[{stationId:t.stationId,allDiscount:t.allDiscount,allMoney:t.allMoney,allTransCount:t.allTransCount,allVolume:t.allVolume}],l.myData2=t.nozzleNumCollectList,l.myData3=t.payTypeCollectList,l.myData4=t.oilNameCollectList,l.totalServerItems=t.allCount,s.clear()},l.setPagingData=function(t,e){a.myPost2(i.URL.systemUrl,l.getTransCollectSendData,i.msgIdName.getTransCollectMsgId,i.msgIdName.getTransCollectMsgName,l.callback)},l.getPagedDataAsync=function(t,e,a){setTimeout(function(){s.pop("wait",constantsLang[l.app.myData.lang].load.reqData,constantsLang[l.app.myData.lang].load.loadingData),l.setPagingData(e,t)},100)},l.gridOptions={i18n:"undefined"!=l.app.myData.lang?l.app.myData.lang:"zh-cn",data:"myData",rowHeight:28,enableRowSelection:!1,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,filterOptions:l.filterOptions},l.gridOptions2={data:"myData2",rowHeight:28,enableRowSelection:!1,columnDefs:"columnDefs2",enableColumnResize:!0,filterOptions:l.filterOptions},l.gridOptions3={data:"myData3",rowHeight:28,enableRowSelection:!1,columnDefs:"columnDefs3",enableColumnResize:!0,filterOptions:l.filterOptions},l.gridOptions4={data:"myData4",rowHeight:28,enableRowSelection:!1,columnDefs:"columnDefs4",enableColumnResize:!0,filterOptions:l.filterOptions},l.goQuery=function(){l.startDate=$("#startDate").val(),l.stopDate=$("#stopDate").val(),""!=l.selected_customerId&&""!=l.selected_stationId?(""!=$("#startDate").val()&&(l.getTransCollectSendData.startTime=$("#startDate").val()),""!=$("#stopDate").val()&&(l.getTransCollectSendData.startTime.stopTime=$("#stopDate").val()),console.log(l.getTransCollectSendData),l.getPagedDataAsync(l.pagingOptions.pageSize,1,l.filterOptions.filterText)):s.pop("warn","警告","未选择客户或站点...")}}]);