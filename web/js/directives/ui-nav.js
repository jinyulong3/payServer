angular.module("app").directive("uiNav",["$timeout",function(e){return{restrict:"AC",link:function(e,a,t){var n,s=$(window),i=$(".app-aside");a.on("click","a",function(e){n&&n.trigger("mouseleave.nav");var a=$(this);a.parent().siblings(".active").toggleClass("active"),a.next().is("ul")&&a.parent().toggleClass("active")&&e.preventDefault(),a.next().is("ul")||s.width()<768&&$(".app-aside").removeClass("show off-screen")}),a.on("mouseenter","a",function(e){if(n&&n.trigger("mouseleave.nav"),$("> .nav",i).remove(),!(!$(".app-aside-fixed.app-aside-folded").length||s.width()<768||$(".app-aside-dock").length)){var a,t=$(e.target),o=$(window).height();t.is("a")||(t=t.closest("a")),t.next().is("ul")&&(n=t.next(),t.parent().addClass("active"),a=t.parent().position().top+50,n.css("top",a),a+n.height()>o&&n.css("bottom",0),o<a+150&&n.css("bottom",o-a-50).css("top","auto"),n.appendTo(i),n.on("mouseleave.nav",function(e){$(".dropdown-backdrop").remove(),n.appendTo(t.parent()),n.off("mouseleave.nav").css("top","auto").css("bottom","auto"),t.parent().removeClass("active")}),$(".smart").length&&$('<div class="dropdown-backdrop"/>').insertAfter(".app-aside").on("click",function(e){e&&e.trigger("mouseleave.nav")}))}}),i.on("mouseleave",function(e){n&&n.trigger("mouseleave.nav"),$("> .nav",i).remove()})}}}]);